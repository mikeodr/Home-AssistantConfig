script:
  blue_set_led:
    alias: "Inovelli Blue 2-1 LED Script"
    fields:
      color:
        description: "Color to set the color effect"
        example: "0 - red/255 - white"
      effect:
        description: "Effect pattern for LED"
        example: "solid"
      level:
        description: "Brightness level"
        example: "100"
      duration:
        description: "Duration of effect, 255 - permanent"
        example: "255"
      entity_id:
        description: "Entities to set the pattern for"
    sequence:
      - repeat:
          for_each: "{{ entity_id }}"
          sequence:
            - variables:
                z2m_id: >-
                  {% set identifiers = device_attr(repeat.item, "identifiers") | first %}
                  {{ identifiers[1].split('_') | last }}
            - service: mqtt.publish
              data:
                topic_template: "zigbee2mqtt/{{ z2m_id }}/set"
                payload_template: >-
                  {"led_effect": {"effect": "{{ effect }}",
                   "color": "{{ color }}",
                   "level": "{{ level }}",
                   "duration": "{{ duration }}"}}

  lzw30_set_led:
    alias: "Inovelli LZW30 LED Status"
    mode: restart
    sequence:
      - service: zwave_js.set_config_parameter
        target:
          entity_id: "{{ entity }}"
        data:
          # Set LED Colouro, value 0-255
          value: "{{ led_colour }}"
          parameter: "5"
      - service: zwave_js.set_config_parameter
        target:
          entity_id: "{{ entity }}"
        data:
          # Set LED brightness to 100%
          # Value from 0 to 10
          value: "{{ led_brightness }}"
          parameter: "6"

  lzw31_set_led:
    alias: "Inovelli LZW31 LED Status"
    mode: restart
    sequence:
      - service: zwave_js.set_config_parameter
        target:
          entity_id: "{{ entity }}"
        data:
          # Set LED Colouro, value 0-255
          value: "{{ led_colour }}"
          parameter: "13"
      - service: zwave_js.set_config_parameter
        target:
          entity_id: "{{ entity }}"
        data:
          # Set LED brightness to 100%
          # Value from 0 to 10
          value: "{{ led_brightness }}"
          parameter: "14"
